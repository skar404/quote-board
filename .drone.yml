pipeline:

  test:
    image: golang:1.12
    commands:
      - sh ./cli/get_coverpro_file.sh
      - bash <(curl -s https://codecov.io/bash) -t ${CODECOV_TOKEN}
    secrets: [CODECOV_TOKEN]

  build:
    image: plugins/docker
    repo: username502/quote-board
    secrets: [docker_username, docker_password]
    build_args:
      - DRONE=${DRONE}
      - DRONE_TAG=${DRONE_TAG}
      - DRONE_COMMIT=${DRONE_COMMIT}
      - DRONE_BRANCH=${DRONE_BRANCH}
